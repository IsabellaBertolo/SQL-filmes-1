-- Acrescentar os novos campos

ALTER TABLE ENTRETERIMENTO
ADD COLUMN RANKING INT;

ALTER TABLE ENTRETERIMENTO
ADD COLUMN RANKING_TIPO VARCHAR(50);

ALTER TABLE ENTRETERIMENTO
ADD COLUMN RANKING_NOME VARCHAR(50);

-- Add filmes da netflix, amazon e etc.

INSERT INTO ENTRETERIMENTO (NOME, TIPO, DIRETOR, ATOR_PRINCIPAL, ATRIZ_PRINCIPAL, ANO_LANCAMENTO, DURACAO_MINUTOS, CLASSIFICACAO_ETARIA, GENERO, NACIONALIDADE, RANKING_NOME, RANKING_TIPO)
VALUES 
('Dark', 'SÉRIE', 'Baran bo Odar', 'Louis Hofmann', 'Lisa Vicari', 2017, 60, '16+', 'Thriller', 'Alemanha', 'Netflix', 'Mundial');

INSERT INTO ENTRETERIMENTO (NOME, TIPO, DIRETOR, ATOR_PRINCIPAL, ATRIZ_PRINCIPAL, ANO_LANCAMENTO, DURACAO_MINUTOS, CLASSIFICACAO_ETARIA, GENERO, NACIONALIDADE, RANKING_NOME, RANKING_TIPO)
VALUES 
('Roma', 'FILME', 'Alfonso Cuarón', 'Yalitza Aparicio', 'Marina de Tavira', 2018, 135, '16+', 'Thriller/Drama', 'México', 'Netflix', 'Mundial');

INSERT INTO ENTRETERIMENTO (NOME, TIPO, DIRETOR, ATOR_PRINCIPAL, ATRIZ_PRINCIPAL, ANO_LANCAMENTO, DURACAO_MINUTOS, CLASSIFICACAO_ETARIA, GENERO, NACIONALIDADE, RANKING_NOME, RANKING_TIPO)
VALUES 
('The Boys', 'SÉRIE', 'Eric Kripke', 'Karl Urban', 'Elisabeth Shue', 2019, 55, '18+', 'Ação', 'Estados Unidos', 'Amazon Prime', 'Mundial');

INSERT INTO ENTRETERIMENTO (NOME, TIPO, DIRETOR, ATOR_PRINCIPAL, ATRIZ_PRINCIPAL, ANO_LANCAMENTO, DURACAO_MINUTOS, CLASSIFICACAO_ETARIA, GENERO, NACIONALIDADE, RANKING_NOME, RANKING_TIPO)
VALUES 
('The Grand Tour', 'SÉRIE', 'Jeremy Clarkson', 'Jeremy Clarkson', 'Richard Hammond', 2016, 60, '14+', 'Comédia', 'Reino Unido', 'Amazon Prime', 'Mundial');

INSERT INTO ENTRETERIMENTO (NOME, TIPO, DIRETOR, ATOR_PRINCIPAL, ATRIZ_PRINCIPAL, ANO_LANCAMENTO, DURACAO_MINUTOS, CLASSIFICACAO_ETARIA, GENERO, NACIONALIDADE, RANKING_NOME, RANKING_TIPO)
VALUES 
('Cidade de Deus', 'FILME', 'Fernando Meirelles', 'Alexandre Rodrigues', 'Alice Braga', 2002, 130, '18+', 'Crime/Drama', 'Brasil', 'Meu Rank', 'Nacional');

INSERT INTO ENTRETERIMENTO (NOME, TIPO, DIRETOR, ATOR_PRINCIPAL, ATRIZ_PRINCIPAL, ANO_LANCAMENTO, DURACAO_MINUTOS, CLASSIFICACAO_ETARIA, GENERO, NACIONALIDADE, RANKING_NOME, RANKING_TIPO)
VALUES 
('O Auto da Compadecida', 'FILME', 'Guel Arraes', 'Matheus Nachtergaele', 'Denise Fraga', 2000, 104, '12+', 'Comédia/Drama', 'Brasil', 'Meu Rank', 'Nacional');



UPDATE ENTRETERIMENTO SET RANKING_NOME = 'NETFLIX' WHERE RANKING_NOME IS NULL;

UPDATE ENTRETERIMENTO SET RANKING_TIPO = 'Nacional' WHERE RANKING_NOME = 'NETFLIX';
UPDATE ENTRETERIMENTO SET RANKING_TIPO = 'Nacional' WHERE RANKING_NOME = 'AMAZON PRIME';
UPDATE ENTRETERIMENTO SET RANKING_TIPO = 'Nacional' WHERE RANKING_NOME = 'MEU RANKING';

UPDATE ENTRETERIMENTO
SET RANKING = (@counter := @counter + 1) -- Incrementa o contador e atribui o valor ao campo RANKING
ORDER BY RAND(); -- Ordena aleatoriamente os registros

-- Atualiza o campo RANKING_TIPO para indicar que é um ranking aleatório
UPDATE ENTRETERIMENTO
SET RANKING_TIPO = 'Aleatório';
